# 역량 평가 시험 기능 가이드

## 개요
핫셀러 CRM에 직원 역량 평가 시험 기능이 추가되었습니다. 이 기능을 통해 직원들은 13개 문항의 주관식 시험을 보고, 어드민은 직원들의 답변을 조회할 수 있습니다.

## 기능 설명

### 일반 사용자 기능
1. **시험 시작**: 설정 페이지의 '계정 정보' 섹션에서 [시험 시작] 버튼 클릭
2. **답변 작성**: 13개 문항에 대한 답변을 작성
3. **임시 저장**: [저장하기] 버튼으로 작성 중인 답변을 임시 저장 (여러 번 가능)
4. **최종 제출**: [제출하기] 버튼으로 최종 제출 (제출 후 수정 불가)

### 어드민 기능
1. **답변 조회**: 설정 페이지의 '직원 관리' 테이블에서 각 직원의 [📄] 아이콘 클릭
2. **제출 현황 확인**: 각 직원의 제출 완료 여부 및 제출 시각 확인
3. **답변 내용 확인**: 제출된 답변 내용을 읽기 전용으로 조회

## 시험 문항

### 한국어 버전
1. KPI란 무엇이고, 왜 사용하는가?
2. OKR란 무엇이고, 왜 사용하는가?
3. PDCA란 무엇이고, 왜 사용하는가?
4. BSC란 무엇이고, 왜 사용하는가?
5. 국내 쇼핑몰들의 가격을 비교하여 최저가를 찾아주는 웹 사이트를 만들어라 라는 업무 지시를 받았다. 업무 시작부터 마무리까지 단계별로 작성하시오.
6. 소를 기르고있는데, 1시간 정도 자리를 비우고 돌아와보니 소 한마리가 외양간을 탈출해 있었다. 어떤 절차로 이 문제를 해결할 것인지 단계별로 작성하시오.
7. 업무보고시 미괄식을 사용하면 안되는 이유는 무엇인가?
8. 자료에 중복, 누락, 혼재가 있을경우 각각 어떤 문제를 발생시킬수 있는가?
9. 아래 조건을 읽고 본인이 실제로 창출했다고 볼 수 있는 매출이익을 산출하고 설명하시오.
   - 회사 전체 인원 50명 (모든 직원의 연봉은 3600만원으로 동일)
   - 지원부서 인원 5명 (인사, 총무, 재무 등 전부서 지원)
   - 지원부서는 모든 부서의 동일한 리소스를 투입하며, 각 부서의 매출이익에는 지원부서의 기여가 포함된다
   - 본인이 속한 부서의 프로젝트에서 3명이 함께 1500만원의 매출이익(매출-원가)을 창출함
   - 본인의 기여도는?
10. 9번 문제를 토대로 회사에서 1인에게 지출되는 요소들과 비용의 구성을 근거있는 수치로 작성해보시오.
11. 10번 문제를 토대로 영업이익을 산출하려면 매출이익에서 어떤비용을 빼야하는지 작성하시오.
12. 9~11번 문제를 토대로 회사에서 적자를 내지 않으려면 본인이 창출해야하는 최소 매출이익은 얼마인가?
13. 핫셀러에서 자신이 창출해야하는 최소 매출이익은 얼마인가?

### 일본어 버전
1. KPIとは何か、なぜ使用するのか？
2. OKRとは何か、なぜ使用するのか？
3. PDCAとは何か、なぜ使用するのか？
4. BSCとは何か、なぜ使用するのか？
5. 国内のショッピングモールの価格を比較して最安値を見つけるウェブサイトを作れという業務指示を受けた。業務の開始から終了までのステップを段階別に作成しなさい。
6. 牛を飼っているが、1時間ほど席を外して戻ってみると、牛1頭が牛舎から脱走していた。どのような手順でこの問題を解決するのか、段階別に作成しなさい。
7. 業務報告の際、尾括式（結論を最後に持ってくる形式）を使用してはいけない理由は何か。
8. 資料に重複、漏れ、混在がある場合、それぞれどのような問題が発生し得るか。
9. 下記の条件を読み、本人が実際に創出したと見なせる売上総利益を算出し、説明しなさい。
   - 全体50名（年収3600万同一）
   - 支援部門5名（人事、総務、財務など全部署支援）
   - 支援部門は全部署に同一のリソースを投入し、各部署の売上総利益には支援部門の寄与が含まれる
   - 本人が所属する部署のプロジェクトで3名で150万円の売上総利益（売上-原価）を創出
   - 本人の寄与度は？
10. 問9に基づき、会社で1人に対して支出される要素と費用の構成を、根拠のある数値で作成しなさい。
11. 問10に基づき、営業利益を算出するには売上総利益からどのような費用を差し引くべきか作成しなさい。
12. 問9〜11に基づき、会社で赤字を出さないために本人が創出すべき最小の売上総利益はいくらか。
13. ホットセラー（Hot Seller）において、自身が創出すべき最小の売上総利益はいくらか。

## 기술 구조

### 데이터베이스
- **테이블**: `exam_answers`
- **주요 컬럼**:
  - `user_id`: 사용자 ID (Foreign Key to users)
  - `answers`: JSONB 형태의 답변 저장
  - `is_submitted`: 제출 완료 여부
  - `submitted_at`: 제출 시각
  - `created_at`, `updated_at`: 생성/수정 시각

### API 엔드포인트
- `GET /api/exam/my-answers`: 본인의 답변 조회
- `POST /api/exam/save-answers`: 답변 임시 저장
- `POST /api/exam/submit-answers`: 답변 최종 제출
- `GET /api/exam/user/:userId/answers`: 특정 사용자 답변 조회 (어드민 전용)
- `GET /api/exam/all-submission-status`: 전체 직원 제출 현황 조회 (어드민 전용)

### 프론트엔드 컴포넌트
- `ExamModal.tsx`: 일반 사용자용 시험 응시 모달
- `ExamViewModal.tsx`: 어드민용 답변 조회 모달
- `SettingsPage.tsx`: 시험 기능이 통합된 설정 페이지

### 다국어 지원
- `i18n/index.ts`에 한국어/일본어 번역 추가
- 사용자의 언어 설정에 따라 문항 자동 전환
- 9번 문항의 금액도 언어에 따라 변경 (한국어: 1500만원, 일본어: 150만엔)

## 배포 방법

### 1. 데이터베이스 마이그레이션
```bash
cd cursor/server
psql $DATABASE_URL < database/create_exam_answers_table.sql
```

### 2. 백엔드 배포
```bash
cd cursor/server
npm run build
# Railway나 다른 플랫폼에 자동 배포
```

### 3. 프론트엔드 배포
```bash
cd cursor/client
npm run build
# Railway나 다른 플랫폼에 자동 배포
```

## 주의사항

1. **제출 후 수정 불가**: 한 번 제출된 답변은 수정할 수 없습니다.
2. **1인 1회 제출**: 각 직원은 한 번만 시험을 제출할 수 있습니다.
3. **어드민 권한**: 답변 조회는 `role='admin'`인 사용자만 가능합니다.
4. **데이터 보안**: 답변은 데이터베이스에 암호화되지 않고 저장되므로, 민감한 개인정보를 포함하지 않도록 주의하세요.

## 향후 개선사항 (선택사항)

1. **자동 채점 시스템**: 특정 키워드나 패턴을 기반으로 점수 자동 산출
2. **통계 대시보드**: 전체 직원의 제출률, 평균 답변 길이 등 통계 제공
3. **답변 평가 기능**: 어드민이 각 답변에 피드백이나 점수를 부여할 수 있는 기능
4. **시험 버전 관리**: 여러 버전의 시험 문항을 관리하고 선택적으로 적용
5. **알림 기능**: 미제출 직원에게 자동 알림 발송

## 문제 해결

### 시험 모달이 열리지 않는 경우
- 브라우저 콘솔에서 에러 메시지 확인
- 백엔드 서버가 정상적으로 실행 중인지 확인
- API 엔드포인트가 올바르게 설정되어 있는지 확인

### 답변이 저장되지 않는 경우
- 네트워크 탭에서 API 요청/응답 확인
- 데이터베이스 연결 상태 확인
- 백엔드 로그에서 에러 메시지 확인

### 어드민이 답변을 볼 수 없는 경우
- 사용자의 `role`이 `'admin'`인지 확인
- 해당 직원이 시험을 제출했는지 확인

## 지원

문제가 발생하거나 질문이 있는 경우, 시스템 관리자에게 문의하세요.
